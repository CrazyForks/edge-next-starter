name = "cloudflare-worker-template-prod"
compatibility_date = "2026-02-12"
compatibility_flags = ["nodejs_compat"]
main = "dist/server/index.js"
no_bundle = true

# Treat JS files as ES modules (vinext build output is pre-bundled)
[[rules]]
type = "ESModule"
globs = ["**/*.js", "**/*.mjs"]

# Static assets (vinext build output)
[assets]
not_found_handling = "none"
directory = "dist/client"

# D1 database binding
[[d1_databases]]
binding = "DB"
database_name = "cloudflare-worker-template-prod"
database_id = "6e91e757-b85e-4d43-a2c4-6c503e0cc9c2"
migrations_dir = "migrations"

# R2 bucket binding
[[r2_buckets]]
binding = "BUCKET"
bucket_name = "cloudflare-worker-template-prod"

# KV namespace
[[kv_namespaces]]
binding = "KV"
id = "52ca46605f5d4d0698f4d0bceac713a1"

# Workers Logs â€” collect console output for debugging
[observability.logs]
enabled = true
invocation_logs = true

# Environment variables
[vars]
ENVIRONMENT = "production"
ANALYTICS_SINK = "engine"
SITE_URL = "https://cloudflare-worker-template-prod.t-ac5.workers.dev"
# Configure NEXTAUTH_SECRET via `wrangler secret put NEXTAUTH_SECRET` to avoid committing secrets
# Configure STRIPE_SECRET_KEY via `wrangler secret put STRIPE_SECRET_KEY`
# Configure STRIPE_WEBHOOK_SECRET via `wrangler secret put STRIPE_WEBHOOK_SECRET`

# Analytics Engine dataset binding
[[analytics_engine_datasets]]
binding = "ANALYTICS"
dataset = "prod_analytics_dataset"
